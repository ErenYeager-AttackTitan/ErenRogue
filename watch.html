<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Watch Channel - ErenRogue</title>
</head>
<body>
    <h1>Watch Channel</h1>
    
    <!-- Back to Home Link -->
    <a href="index.html">Back to Home</a>

    <div id="channelDetails"></div>

    <div id="videoPlayer">
        <!-- Video player will be inserted here -->
    </div>

    <script>
        // Get the channel ID from the URL query string
        const urlParams = new URLSearchParams(window.location.search);
        const channelId = urlParams.get('id');
        
        // Fetch the channel data from animax.json or all.json based on the ID
        fetch('/all.json')
            .then(response => response.json())
            .then(data => {
                const channel = data.find(item => item.id === channelId);
                
                if (channel) {
                    displayChannelDetails(channel);
                    createVideoPlayer(channel.streamUrl);
                } else {
                    document.getElementById('channelDetails').innerHTML = "<p>Channel not found.</p>";
                }
            })
            .catch(error => {
                console.error("Error fetching channel data:", error);
                document.getElementById('channelDetails').innerHTML = "<p>Error loading channel details.</p>";
            });

        // Function to display channel details (name, description, and poster)
        function displayChannelDetails(channel) {
            const channelDetailsDiv = document.getElementById('channelDetails');
            channelDetailsDiv.innerHTML = `
                <h2>${channel.channelName}</h2>
                <img src="${channel.poster}" alt="${channel.channelName} Poster" width="300">
                <p>${channel.description}</p>
            `;
        }

        // Function to create the video player for the channel stream (using the M3U8 URL)
        function createVideoPlayer(streamUrl) {
            const videoPlayerDiv = document.getElementById('videoPlayer');
            const videoElement = document.createElement('video');
            videoElement.controls = true;
            videoElement.width = "640";
            videoElement.height = "360";
            
            // Create the source element for the M3U8 stream
            const sourceElement = document.createElement('source');
            sourceElement.src = streamUrl;
            sourceElement.type = "application/x-mpegURL";
            videoElement.appendChild(sourceElement);
            
            // Append the video element to the video player div
            videoPlayerDiv.appendChild(videoElement);
        }
    </script>
</body>
</html>
